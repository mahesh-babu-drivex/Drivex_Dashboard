{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "refurbishment",
    "datasource": {
      "name": "Postgres",
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "Postgres",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Page1",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "WITH MTD_CTE AS (\n    SELECT\n        COALESCE(qc_dtc, 'N/A') AS qc_dtc,\n        COUNT(*) AS mtd_count\n    FROM\n        cleaned_live_data.\"dtc_QC\"\n    WHERE\n        EXTRACT(YEAR FROM qc_time) = EXTRACT(YEAR FROM CURRENT_DATE)\n        AND EXTRACT(MONTH FROM qc_time) = EXTRACT(MONTH FROM CURRENT_DATE)\n    GROUP BY\n        qc_dtc\n),\nYESTERDAY_CTE AS (\n    SELECT\n        COALESCE(qc_dtc, 'N/A') AS qc_dtc,\n        COUNT(*) AS yesterday_count\n    FROM\n        cleaned_live_data.\"dtc_QC\"\n    WHERE\n        DATE(qc_time) = CURRENT_DATE - INTERVAL '1 day'\n    GROUP BY\n        qc_dtc\n)\nSELECT\n    qc_dtc,\n    COALESCE(mtd_count, 0) AS mtd_count,\n    COALESCE(yesterday_count, 0) AS yesterday_count\nFROM (\n    SELECT\n        MTD_CTE.qc_dtc,\n        MTD_CTE.mtd_count,\n        YESTERDAY_CTE.yesterday_count\n    FROM\n        MTD_CTE\n    LEFT JOIN YESTERDAY_CTE ON MTD_CTE.qc_dtc = YESTERDAY_CTE.qc_dtc\n\n    UNION ALL\n\n    SELECT\n        'Total' AS qc_dtc,\n        COALESCE(SUM(MTD_CTE.mtd_count), 0) AS mtd_count,\n        COALESCE(SUM(YESTERDAY_CTE.yesterday_count), 0) AS yesterday_count\n    FROM\n        MTD_CTE\n    LEFT JOIN YESTERDAY_CTE ON MTD_CTE.qc_dtc = YESTERDAY_CTE.qc_dtc\n) AS combined_data\nORDER BY\n    qc_dtc;\n",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": [],
    "createdAt": "2023-11-09T07:32:19Z"
  },
  "id": "Page1_refurbishment",
  "deleted": false,
  "gitSyncId": "654c5d4e80e26167c30e16c9_654c8b0380e26167c30e1709"
}